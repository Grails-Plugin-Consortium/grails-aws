<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>3 Amazon Simple Email Service (AWS SES) 1.2.12.3</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/1%20Introduction%20to%20Grails%20AWS%20Plugin.html"><strong>1</strong><span>Introduction to Grails AWS Plugin</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/2%20Amazon%20Simple%20Storage%20Service%20(AWS%20S3).html"><strong>2</strong><span>Amazon Simple Storage Service (AWS S3)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/3%20Amazon%20Simple%20Email%20Service%20(AWS%20SES).html"><strong>3</strong><span>Amazon Simple Email Service (AWS SES)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/4%20FAQ.html"><strong>4</strong><span>FAQ</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/5%20Roadmap.html"><strong>5</strong><span>Roadmap</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/6%20Changelog.html"><strong>6</strong><span>Changelog</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/7%20Contributions%20and%20reporting%20bugs.html"><strong>7</strong><span>Contributions and reporting bugs</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/8%20Contact.html"><strong>8</strong><span>Contact</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        
    </div>
    <p>Amazon Web Services (AWS) grails plugin provides easy access to simpler functions of AWS</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/2%20Amazon%20Simple%20Storage%20Service%20(AWS%20S3).html">&lt;&lt; <strong>2</strong><span>Amazon Simple Storage Service (AWS S3)</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/4%20FAQ.html"><strong>4</strong><span>FAQ</span> >></a></div>
                


                <div class="project">
                    <h1>3 Amazon Simple Email Service (AWS SES) - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Lucas Teixeira, Jay Prall</p>

                    <p><strong>Version:</strong> 1.2.12.3</p>

                    
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#3.1%20Configuring%20the%20SES%20options"><strong>3.1</strong><span>Configuring the SES options</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#3.2%20Sending%20text%20emails"><strong>3.2</strong><span>Sending text emails</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#3.3%20Sending%20HTML%20emails"><strong>3.3</strong><span>Sending HTML emails</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#3.4%20Sending%20emails%20with%20attachments"><strong>3.4</strong><span>Sending emails with attachments</span></a>
                    </div>
                    
                </div>
                

                

<h1 id="3 Amazon Simple Email Service (AWS SES)">3 Amazon Simple Email Service (AWS SES)</h1>
Amazon Simple E-mail Service (SES for now), it is a Sending E-mail Service provided by amazon, with a real low cost for users. The plugin interacts with it, so you can send e-mails using SES infrastructure without extra code in your app.<p class="paragraph"/>If you just want to send e-mails using your non-SES infrastructure, this plugin won't help you, I recommend you to use the great <strong class="bold">Grails Mail Plugin</strong> (<a href="http://grails.org/plugin/mail" target="blank">http://grails.org/plugin/mail</a>).<p class="paragraph"/>Unfortunately, SES does not provide a simple SMTP server address to connect and use, otherwise we could just configure the Grails Mail Plugin to use it. Instead of this, AWS provides a http web service for it.<p class="paragraph"/>But, if you really want to use Mail Plugin, you can configure AWS SES with a SMTP Bridge to connect to your SMTP server, but only if you're running Postfix or Sendmail locally. For doing this, check AWS SES Developer Guide.<p class="paragraph"/><strong class="bold">REMBEMBER:</strong> You have to be subscribed to SES, if you are not yet, do it before using the plugin.<p class="paragraph"/><blockquote class="warning">
Attention: If you only subscribed to Amazon SES and still didn't get access for production using, you'll only be allowed to send e-mails 'from' AND 'to' emais that has been verified with amazon. So, you'll have to use the 'grails aws-ses-verify-email' for both sender and recipient adresses. After getting production access, this won't be needed.                
</blockquote>



<h2 id="3.1 Configuring the SES options">3.1 Configuring the SES options</h2>
The plugin provides these configurations for SES service.<p class="paragraph"/><h3>enabled</h3><p class="paragraph"/>The plugin is enabled by default on all environments, you can set 'enabled=false' on some environments to disable email sending. This is useful on testing environments where integration tests runs.<p class="paragraph"/><h3>catchall</h3><p class="paragraph"/>If you set the 'catch all' address, it will override any other address you set in 'to', 'cc' and 'bcc' properties. 
This is useful when you have acceptance tests or other environments/uses that you want your mails to be sent, but not to the usual addresses, but to one and only one address.<p class="paragraph"/>Any attempt to send emails with this property configured, will send e-mails to the address configured, with no 'cc' and 'bcc' addresses.<p class="paragraph"/><h3>from</h3><p class="paragraph"/>The default 'from' address to be used. You can override this parameter in every call to the plugin, setting the 'from' parameter. As said before, this address have to be verified with AWS (check Gant scripts section to see how to do it).<p class="paragraph"/><h3>Configuration example</h3><p class="paragraph"/>To configure it, you'll do the following inside the <strong class="bold">grails.plugin.aws</strong> section of your application Config.<p class="paragraph"/><div class="code"><pre>grails &#123;
   plugin &#123;
      aws &#123;<p class="paragraph"/>         ses &#123;
            enabled = <span class="java&#45;keyword">false</span>
            catchall = <span class="java&#45;quote">"allmailforme@gmail.com"</span>
            from = <span class="java&#45;quote">"my&#45;verified&#45;email@gmail.com"</span>
         &#125;<p class="paragraph"/>      &#125;
   &#125;
&#125;</pre></div><p class="paragraph"/>


<h2 id="3.2 Sending text emails">3.2 Sending text emails</h2>
To send e-mails, just call the <strong class="bold">sesMail</strong> closure in your controllers or services<p class="paragraph"/><div class="code"><pre>def mailId = sesMail &#123;
    from <span class="java&#45;quote">"origin@gmail.com"</span>
    to <span class="java&#45;quote">"test&#45;email@gmail.com"</span>
    subject <span class="java&#45;quote">"test plain text mail"</span>
    body <span class="java&#45;quote">"<span class="java&#45;keyword">this</span> is the e&#45;mail content, sent at: ($&#123;<span class="java&#45;keyword">new</span> Date().format('dd/MM/yyyy HH:mm')&#125;)"</span>
&#125;</pre></div><p class="paragraph"/>The <strong class="bold">sesMail</strong> returns an unique identifier for this e-mail at Amazon infrastructure, as this one:<p class="paragraph"/><div class="code"><pre>0000012dcde0ea1c&#45;d331d2ec&#45;3972&#45;4a6c&#45;825f&#45;fc980cde3352&#45;000000</pre></div><p class="paragraph"/>Amazon don't provide anything useful to do with this <strong class="bold">id</strong> yet, but I imagine that in a near future, you'll be able to retrieve if this email was delivered correctly, or if it was spammed or bounced. So, feel free to store it if you want to.<p class="paragraph"/><h3>Closure parameters</h3><p class="paragraph"/><h4>AWS Credentials</h4><p class="paragraph"/>As the S3 file upload support, you can override AWS credentials settings for sending mails. This is rare and unusual, but if you really need, do the same as in S3.<p class="paragraph"/><div class="code"><pre>credentials <span class="java&#45;quote">"<span class="java&#45;keyword">new</span>&#45;access&#45;key"</span>, <span class="java&#45;quote">"<span class="java&#45;keyword">new</span>&#45;secret&#45;key"</span></pre></div><p class="paragraph"/>Just remember, if this new AWS credentials belong to another AWS account, this account will have to be subscribed to SES service and have verified e-mails to send.<p class="paragraph"/><h4>Defining the sender</h4><p class="paragraph"/>As seen in the other topic, you can set this default address in the application Config, but if you want to explicitly set the address in each email you send, just override the <strong class="bold">from</strong> method:<p class="paragraph"/><div class="code"><pre>from <span class="java&#45;quote">"my&#45;other&#45;email@gmail.com"</span></pre></div><p class="paragraph"/><h4>Defining recipient e-mails</h4><p class="paragraph"/><h5>To</h5><p class="paragraph"/>To set the recipient e-mail, use the <strong class="bold">to</strong> method.<p class="paragraph"/><div class="code"><pre>to <span class="java&#45;quote">"user@myapp.com"</span></pre></div><p class="paragraph"/>You can send to multiple addresses doing this:<p class="paragraph"/><div class="code"><pre>to <span class="java&#45;quote">"user<code>myapp.com"</span>, <span class="java&#45;quote">"user2</code>myapp.com"</span>, <span class="java&#45;quote">"user3@myapp.com"</span></pre></div><p class="paragraph"/><h5>CC and BCC</h5><p class="paragraph"/>To set CC and BCC addresses, you can do the same as <strong class="bold">to</strong> addresses:<p class="paragraph"/><div class="code"><pre>cc <span class="java&#45;quote">"copied@myapp.com"</span></pre></div><p class="paragraph"/><div class="code"><pre>bcc <span class="java&#45;quote">"you&#45;dont&#45;know&#45;me&#64;myapp.com"</span></pre></div><p class="paragraph"/>And again, for multiple addresses:<p class="paragraph"/><div class="code"><pre>ccc <span class="java&#45;quote">"user1&#64;myapp.com"</span>, <span class="java&#45;quote">"user2&#64;myapp.com"</span>, <span class="java&#45;quote">"user3&#64;myapp.com"</span></pre></div><p class="paragraph"/><div class="code"><pre>bcc <span class="java&#45;quote">"user4&#64;myapp.com"</span>, <span class="java&#45;quote">"user5&#64;myapp.com"</span>, <span class="java&#45;quote">"user6&#64;myapp.com"</span></pre></div><p class="paragraph"/><h4>Setting the e-mail subject</h4><p class="paragraph"/>To set the subject, following other parameters convention:<p class="paragraph"/><div class="code"><pre>subject <span class="java&#45;quote">"Testing the AWS Plugin"</span></pre></div><p class="paragraph"/><h4>E-mail body</h4><p class="paragraph"/>And finally, the e-mail body can be set with:<p class="paragraph"/><div class="code"><pre>body <span class="java&#45;quote">"This is the text user will receive in the e&#45;mail body"</span></pre></div><p class="paragraph"/><h4>Defining the reply-to address</h4><p class="paragraph"/>You can set the reply-to header of your mail message using the <strong class="bold">replyTo</strong> closure parameter. And you can pass one string, or a list of e-mails that will be set as 'reply-to' header.<p class="paragraph"/><strong class="bold">One e-mail</strong><p class="paragraph"/><div class="code"><pre>replyTo <span class="java&#45;quote">"my&#45;other&#45;email@gmail.com"</span></pre></div><p class="paragraph"/><strong class="bold">Multiple e-mails</strong>
<div class="code"><pre>replyTo <span class="java&#45;quote">"my&#45;other&#45;email&#45;1<code>gmail.com"</span>, <span class="java&#45;quote">"my&#45;other&#45;email&#45;2</code>gmail.com"</span>, <span class="java&#45;quote">"my&#45;other&#45;email&#45;3@gmail.com"</span></pre></div>



<h2 id="3.3 Sending HTML emails">3.3 Sending HTML emails</h2>
You can send html emails the same way you'd do with text e-mails, just instead of calling the <strong class="bold">body</strong> method, you have to pass the content to the <strong class="bold">html</strong> method:<p class="paragraph"/><div class="code"><pre>sesMail &#123;
   to <span class="java&#45;quote">"email@gmailcom"</span>
   subject <span class="java&#45;quote">"testing html emails"</span>
   html <span class="java&#45;quote">"&#60;html&#62;&#60;body&#62;&#60;h3&#62;HTML email&#60;/h3&#62;&#60;strong&#62;Strong text&#60;/strong&#62;&#60;/body&#62;&#60;/html&#62;"</span>
&#125;</pre></div><p class="paragraph"/><h3>Using GSP templates to generate html emails</h3><p class="paragraph"/>I bet you don't want to write all the HTML in your closure, so, you can design your e-mail in a grails template and use it to define the email content:<p class="paragraph"/><div class="code"><pre>sesMail &#123;
   to <span class="java&#45;quote">"email@gmailcom"</span>
   subject <span class="java&#45;quote">"testing html emails"</span>
   html g.render(template: <span class="java&#45;quote">"/email&#45;templates/template"</span>, model: &#91;name: <span class="java&#45;quote">"Lucas"</span>, now: <span class="java&#45;keyword">new</span> Date()&#93;)
&#125;</pre></div><p class="paragraph"/>This will render the <strong class="bold">/email-templates/_template.gsp</strong> passing the model map to the rendering engine. For example, let's imagine this file has the following content:<p class="paragraph"/><div class="code"><pre>&#60;html&#62;
   &#60;body&#62;
      &#60;h2&#62;Testing e&#45;mail templates&#60;/h2&#62;
      &#60;ul&#62;
         &#60;li&#62;Name: $&#123;name&#125;&#60;/li&#62;
         &#60;li&#62;Now: $&#123;now.format('dd/MM/yyyy HH:mm')&#125;&#60;/li&#62;
      &#60;/ul&#62;
   &#60;/body&#62;
&#60;/html&#62;</pre></div><p class="paragraph"/>This will send the html e-mail with the content below rendered:<p class="paragraph"/><div class="code"><pre>&#60;html&#62;
   &#60;body&#62;
      &#60;h2&#62;Testing e&#45;mail templates&#60;/h2&#62;
      &#60;ul&#62;
         &#60;li&#62;Name: Lucas&#60;/li&#62;
         &#60;li&#62;Now: 28/01/2010 18:02&#60;/li&#62;
      &#60;/ul&#62;
   &#60;/body&#62;
&#60;/html&#62;</pre></div><p class="paragraph"/><blockquote class="warning">
You can use both methods <strong class="bold">html</strong> and <strong class="bold">body</strong> to send e-mails with both content in it. This is usually the best approach, since user may not allowed his email client to render html emails. So, it is up to you.
</blockquote>


<h2 id="3.4 Sending emails with attachments">3.4 Sending emails with attachments</h2>
You can attach one or more files in your e-mail if you want. Keep in mind that AWS SES charges for the amount of data you sent attached in your e-mails.<p class="paragraph"/>It is simple, you just need to call the "attach" method in the sesMail closure with the full path to desired files, like below:<p class="paragraph"/><div class="code"><pre>sesMail &#123;
   to <span class="java&#45;quote">"email@gmailcom"</span>
   subject <span class="java&#45;quote">"testing emails with one attachment"</span>
   body <span class="java&#45;quote">"..."</span>
   attach <span class="java&#45;quote">"/users/website/images/file1.jpg"</span>
&#125;</pre></div><p class="paragraph"/>You can attach several files separating file paths with commas:<p class="paragraph"/><div class="code"><pre>sesMail &#123;
   to <span class="java&#45;quote">"email@gmailcom"</span>
   subject <span class="java&#45;quote">"testing emails with one attachment"</span>
   body <span class="java&#45;quote">"..."</span>
   attach <span class="java&#45;quote">"/users/website/images/file1.jpg"</span>, <span class="java&#45;quote">"/users/website/images/file2.jpg"</span>, <span class="java&#45;quote">"/users/website/images/file3.jpg"</span>
&#125;</pre></div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/2%20Amazon%20Simple%20Storage%20Service%20(AWS%20S3).html">&lt;&lt; <strong>2</strong><span>Amazon Simple Storage Service (AWS S3)</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/4%20FAQ.html"><strong>4</strong><span>FAQ</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">SES</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../ref/SES/aws-ses-get-send-quota.html">aws-ses-get-send-quota</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/SES/aws-ses-get-send-statistics.html">aws-ses-get-send-statistics</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/SES/aws-ses-list-verified-emails.html">aws-ses-list-verified-emails</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/SES/aws-ses-send-ping-mail.html">aws-ses-send-ping-mail</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/SES/aws-ses-verify-email.html">aws-ses-verify-email</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
